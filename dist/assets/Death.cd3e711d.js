import{r as i,l as A,b as m,j as t,a as r,f as h}from"./index.d87dee6f.js";import{D as L}from"./DeleteButton.055862da.js";import{E as _}from"./EditButton.a6d27025.js";import{B as $}from"./Button.3275d51a.js";import{I as S}from"./Input.34d9876e.js";import{S as w}from"./SearchInput.d51e8da3.js";import{S as M}from"./Select.a91200f8.js";import{j as k}from"./react-confirm-alert.30c1f10e.js";import{O as q,a as H}from"./OptionsTh.e3256f46.js";import{T as z,a as G,b as p,c as J,d as l}from"./Thead.63124400.js";import{F as K}from"./FormLayout.630feb8e.js";import{T as Q}from"./Tabs.f2b07210.js";import{I as U}from"./IndexNo.141a2ac1.js";import{T as V}from"./TotalNo.2b8dc21c.js";import{R as W}from"./index.esm.bd88e434.js";import{R as X}from"./ReactPagination.781004e5.js";import{B as Y}from"./ButtonPreloader.e6928a61.js";function ge({role:T}){const{user:s}=i.exports.useContext(A),[D,v]=i.exports.useState([]),[a,g]=i.exports.useState([]),[x,b]=i.exports.useState(1),[I,f]=i.exports.useState(!1),[n,B]=i.exports.useState({staffname:`${s==null?void 0:s.name}`,type:"death",patientid:"",description:"",date:""});function c(e){B(o=>({...o,[e.target.name]:e.target.value}))}function u(){m.get("/report?type=death").then(e=>{g(e.data)}).catch(e=>{h.error(e.data)})}const E=e=>{e.preventDefault(),f(!0),m.post("/report",{type:n==null?void 0:n.type,staffname:n==null?void 0:n.staffname,patientid:n==null?void 0:n.patientid,description:n==null?void 0:n.description,date:n==null?void 0:n.date}).then(o=>{f(!1),u(),h.success(o.data)}).catch(o=>{f(!1),h.error(o.response.data)})};i.exports.useEffect(()=>{m.get("/patient").then(e=>{v(e.data)}),u()},[]);const F=e=>{m.get(`/report?type=death&q=${e}`).then(o=>{g(o.data),b(1)})},d=10,y=x*d,N=y-d,O=a.slice(N,y),j=Math.ceil(a.length/d),R=e=>{b(e.selected+1)};return t(Q,{label1:"Deaths",label2:"Add Death",content1:r("div",{children:[r("div",{className:"flex justify-between items-center",children:[t(w,{onSearch:F}),r("div",{className:"items-center flex flex-col lg:flex-row",children:[t(V,{totalnumber:a==null?void 0:a.length}),t(X,{pageCount:j,handlePageClick:R})]})]}),r(z,{children:[r(G,{children:[t(U,{children:"#"}),t(p,{children:"Reg. Id"}),t(p,{children:"Patient"}),t(p,{children:"Cause"}),t(p,{children:"Date"}),(s==null?void 0:s.role)!=="admin"&&t(q,{children:"Options"})]}),O.map((e,o)=>{var P,C;return r(J,{children:[t(l,{children:o+1*(x*d-9)}),t(l,{className:"font-bold",children:(P=e==null?void 0:e.patients[0])==null?void 0:P.registrationId}),t(l,{children:(C=e==null?void 0:e.patients[0])==null?void 0:C.name}),t(l,{children:e==null?void 0:e.description}),t(l,{children:e==null?void 0:e.date}),(s==null?void 0:s.role)!=="admin"&&r(H,{children:[r(_,{editFunction:`${T}/edit_death?edit=${e==null?void 0:e._id}`,children:["Edit",t(W,{})]}),r(L,{path:"report",id:e==null?void 0:e._id,record:u,children:["Delete",t(k,{})]})]})]},o)})]})]}),content2:t(K,{formName:"ADD DEATH",children:r("form",{onSubmit:E,children:[t("input",{type:"hidden",name:"type",onChange:c}),t("input",{type:"hidden",name:"staffname",onChange:c}),r(M,{label:"Patient",name:"patientid",type:"number",onChange:c,children:[t("option",{value:"",children:"Select Patient"}),D.map((e,o)=>r("option",{value:e==null?void 0:e._id,children:[e==null?void 0:e.registrationId," - ",e==null?void 0:e.name]},o))]}),t(S,{label:"Cause",name:"description",type:"text",onChange:c}),t(S,{label:"Date",type:"datetime-local",name:"date",onChange:c}),t($,{children:I?t(Y,{}):"Add Death"})]})})})}export{ge as D};
